.ui-widget
	%label Alkoholsort
	%input#article{:type=> "text", :name=> "article", :charset=> "utf-8"}
.ui-widget
	%form#selected_articles{:method=> "post", :action=>"/make/order"}
		%input{:type=> "hidden", :name=> "date", :value=> "#{@kroken_date}"}
		%input{:type=> "submit", :value=> "Spara order"}
.ui-widget
	%form{:method=>"post", :action=>'/add/article'}
		%input{:type=> "hidden", :name=> "date", :value=> "#{@kroken_date}"}
		%label Sort:
		%input{:type=> "text", :name=> "name"}
		%label Pris:
		%input{:type=> "text", :name=> "price"}
		%input{:type=> "submit", :value=> "LÃ¤gg till artikel i lager"}
:javascript
	function log(message, article) {
		$("<label>").text("Antal som hämtas ut:").insertAfter($("<label>").text(message).insertBefore($("<input type='text' charset='utf-8'>").attr('name', article).insertBefore($("<input type='button' value='Ta bort' onclick='remove(this)'>").appendTo($("<div>").appendTo("#selected_articles")))))
	};
	function remove(elem) {
		$(elem).parent().remove();
	};
	$(document).ready(function () {
		$("#article").autocomplete({
				source: function (request, response) {
								 $.ajax({
									url: "/all_articles",
									dataType: "jsonp",
									data: {
										featureClass: "P",
										search: request.term
									},
									success: function(data) { 
										response( $.map( data, function( item ) {
										return {
												label: item.name,
												value: item.name + ", pris exkl. moms: " + item.price
											}
						}));
									}
								 });
							},
				minLength: 1,
				select: function(event, ui) {
									log(ui.item.value, ui.item.label)
					}
			});
	});
